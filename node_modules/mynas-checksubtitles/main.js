var oTransform = new require('stream').Transform({ objectMode: true });
var _ = require("lodash");
var oFs = require("fs");


function checkSubtitles() {

    oTransform._transform = function(oInput, encoding, done) {

        var oStream = this;

        var oModuleData = {
            exists: false
        };



        var sPath = oInput.path;

        var aTmp = sPath.split(".");
        aTmp.length--;
        aTmp.push("srt");

        sPath = aTmp.join(".");

        oFs.exists(sPath, function(bExists) {

            if (bExists) {
                oModuleData.exists = true;
            }

            oInput["checkSubtitles"] = oModuleData;


            oStream.push(oInput);
            done();
        });
    };

    return oTransform;


}


module.exports = checkSubtitles;
